---
title: "CTCAC in Context"
author: "Colin Ries"
header-includes:
- \usepackage{booktabs}
- \usepackage{siunitx}
- \newcolumntype{d}{S[input-symbols = ()]}
output:
  slidy_presentation: default
  html_notebook: default
  pdf_document: default
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(warning=FALSE)

```

# Introduction

Measuring a program impact

- Evolving legal landscape
- Changing federal policies
- Shifting administrative priorities
- Public and elite attitudes


---

# Data & Methods

```{r packages}

library(tidyverse)
library(haven)

```


```{r import-data}
# Load National LIHTC data
lihtc <- read_csv('../data/LIHTCPUB.CSV')

# lihtc <-  lihtc %>% 
#   filter((yr_alloc >= 2003) & (yr_alloc <= 2019)) %>% 
#   filter(!is.na(dda))

ctcac <- lihtc %>% 
  filter(proj_st == 'CA') %>% 
  mutate(qct = 0+ 1*(qct==1)) %>% 
  mutate(dda = 1*(dda!=0))

```

```{r qct}

qct_sites <- lihtc %>% 
  group_by(proj_st, yr_alloc) %>%
  mutate(qct = 0+ 1*(qct==1)) %>% 
  summarise(y= sum(qct)/n())

ggplot(data = ca_qcts) +
  geom_line(mapping = aes(
    x=yr_alloc, 
    y = y))

```

```{r dda}

dda_sites <- lihtc %>%
  group_by(proj_st, yr_alloc) %>%
  # Do not distinguish between metro and non-metro DDAs
  mutate(dda = 1*(dda!=0)) %>% 
  summarise(y= sum(dda)/n())

ggplot(data = dda_sites) +
  geom_line(mapping = aes(
    x=yr_alloc, 
    y = y, 
    group= proj_st,
    color = proj_st))

```

